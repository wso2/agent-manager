openapi: 3.0.3
info:
  version: 1.0.0
  title: Agent Manager Service API
servers:
  - url: /api/v1
paths:
  /orgs:
    get:
      summary: List all organizations
      operationId: listOrganizations
      parameters:
        - name: limit
          in: query
          description: Maximum number of results to return
          required: false
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 50
        - name: offset
          in: query
          description: Number of results to skip
          required: false
          schema:
            type: integer
            default: 0
            minimum: 0
      responses:
        "200":
          description: List of organizations
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrganizationListResponse"
        "400":
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Create a new organization
      operationId: createOrganization
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateOrganizationRequest"
      responses:
        "202":
          description: Organization creation initiated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrganizationResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}:
    get:
      summary: Get organization details
      operationId: getOrganization
      parameters:
        - name: orgName
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Organization details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrganizationResponse"
        "404":
          description: Organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}/deployment-pipelines:
    get:
      summary: List all deployment pipelines in an organization
      operationId: listDeploymentPipelines
      parameters:
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: limit
          in: query
          description: Maximum number of results to return
          required: false
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 50
        - name: offset
          in: query
          description: Number of results to skip
          required: false
          schema:
            type: integer
            default: 0
            minimum: 0
      responses:
        "200":
          description: List of deployment pipelines
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeploymentPipelineListResponse"
        "400":
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}/projects:
    post:
      summary: Create a new project
      operationId: createProject
      parameters:
        - name: orgName
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateProjectRequest"
      responses:
        "202":
          description: Project creation initiated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ProjectResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: Project already exists
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    get:
      summary: List all projects in an organization
      operationId: listProjects
      parameters:
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: limit
          in: query
          description: Maximum number of results to return
          required: false
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 50
        - name: offset
          in: query
          description: Number of results to skip
          required: false
          schema:
            type: integer
            default: 0
            minimum: 0
      responses:
        "200":
          description: List of projects
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ProjectListResponse"
        "400":
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}/projects/{projName}:
    get:
      summary: Get project details
      operationId: getProject
      parameters:
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: projName
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Project details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ProjectResponse"
        "404":
          description: Project not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    put:
      summary: Update project
      operationId: updateProject
      parameters:
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: projName
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateProjectRequest"
      responses:
        "200":
          description: Project updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ProjectResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Project not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      summary: Delete a project
      operationId: deleteProject
      parameters:
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: projName
          in: path
          required: true
          schema:
            type: string
      responses:
        "204":
          description: Project deleted successfully
        "404":
          description: Project not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}/projects/{projName}/agents:
    post:
      summary: Create a new agent
      operationId: createAgent
      parameters:
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: projName
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateAgentRequest"
      responses:
        "202":
          description: Agent creation initiated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgentResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: Agent already exists
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    get:
      summary: List all agents in a project of an organization
      operationId: listAgents
      parameters:
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: projName
          in: path
          required: true
          schema:
            type: string
        - name: limit
          in: query
          description: Maximum number of results to return
          required: false
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 50
        - name: offset
          in: query
          description: Number of results to skip
          required: false
          schema:
            type: integer
            default: 0
            minimum: 0
      responses:
        "200":
          description: List of agents
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgentListResponse"
        "400":
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}/projects/{projName}/agents/{agentName}:
    get:
      summary: Get agent details
      operationId: getAgent
      parameters:
        - name: agentName
          in: path
          required: true
          schema:
            type: string
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: projName
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Agent details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgentResponse"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    put:
      summary: Update agent basic information
      operationId: updateAgent
      parameters:
        - name: agentName
          in: path
          required: true
          schema:
            type: string
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: projName
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateAgentBasicInfoRequest"
      responses:
        "200":
          description: Agent updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgentResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      summary: Delete agent
      operationId: deleteAgent
      parameters:
        - name: agentName
          in: path
          required: true
          schema:
            type: string
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: projName
          in: path
          required: true
          schema:
            type: string
      responses:
        "204":
          description: Agent deleted successfully
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}/projects/{projName}/agents/{agentName}/build-parameters:
    put:
      summary: Update agent build parameters
      operationId: updateAgentBuildParameters
      parameters:
        - name: agentName
          in: path
          required: true
          schema:
            type: string
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: projName
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateAgentBuildParametersRequest"
      responses:
        "200":
          description: Agent build parameters updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgentResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}/projects/{projName}/agents/{agentName}/resource-configs:
    get:
      summary: Get agent resource configurations
      operationId: getAgentResourceConfigs
      parameters:
        - name: agentName
          in: path
          required: true
          schema:
            type: string
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: projName
          in: path
          required: true
          schema:
            type: string
        - name: environment
          in: query
          description: Optional environment name. If omitted, returns component-level defaults. If provided, returns environment-specific overrides (if any) along with component defaults and isDefaultsOverridden flag.
          required: false
          schema:
            type: string
      responses:
        "200":
          description: Agent resource configurations retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgentResourceConfigsResponse"
        "404":
          description: Agent or environment not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    put:
      summary: Update agent resource configurations
      operationId: updateAgentResourceConfigs
      parameters:
        - name: agentName
          in: path
          required: true
          schema:
            type: string
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: projName
          in: path
          required: true
          schema:
            type: string
        - name: environment
          in: query
          description: Optional environment name. If provided, updates only that environment's resource configurations via release binding componentTypeEnvOverrides. If omitted, updates component-level defaults that apply to all environments (unless overridden).
          required: false
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateAgentResourceConfigsRequest"
      responses:
        "200":
          description: Agent resource configurations updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgentResourceConfigsResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}/utils/generate-name:
    post:
      summary: Get name by display name
      description: Retrieve name using display name for a specific resource
      operationId: getNameByDisplayName
      parameters:
        - name: orgName
          in: path
          description: Organization name
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResourceNameRequest"
      responses:
        "200":
          description: Agent name retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResourceNameResponse"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}/projects/{projName}/agents/{agentName}/builds:
    post:
      summary: Build an agent
      operationId: buildAgent
      parameters:
        - name: agentName
          in: path
          required: true
          schema:
            type: string
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: projName
          in: path
          required: true
          schema:
            type: string
        - name: commitId
          in: query
          schema:
            type: string
      responses:
        "202":
          description: Build initiated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BuildResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    get:
      summary: Get Builds of an Agent
      operationId: getAgentBuilds
      parameters:
        - name: agentName
          in: path
          required: true
          schema:
            type: string
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: projName
          in: path
          required: true
          schema:
            type: string
        - name: limit
          in: query
          description: Maximum number of results to return
          required: false
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 50
        - name: offset
          in: query
          description: Number of results to skip
          required: false
          schema:
            type: integer
            default: 0
            minimum: 0
      responses:
        "200":
          description: fetch builds successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BuildsListResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /orgs/{orgName}/projects/{projName}/agents/{agentName}/builds/{buildName}:
    get:
      summary: Get build details
      operationId: getBuild
      parameters:
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: projName
          in: path
          required: true
          schema:
            type: string
        - name: agentName
          in: path
          required: true
          schema:
            type: string
        - name: buildName
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Build details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BuildDetailsResponse"
        "404":
          description: Build not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /orgs/{orgName}/projects/{projName}/agents/{agentName}/builds/{buildName}/build-logs:
    get:
      summary: Get build logs
      operationId: getBuildLogs
      parameters:
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: projName
          in: path
          required: true
          schema:
            type: string
        - name: agentName
          in: path
          required: true
          schema:
            type: string
        - name: buildName
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Build logs
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LogsResponse"
        "404":
          description: Build not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}/projects/{projName}/agents/{agentName}/deployments:
    post:
      summary: Deploy an agent
      operationId: deployAgent
      parameters:
        - name: agentName
          in: path
          required: true
          schema:
            type: string
        - name: orgName
          in: path
          required: true
          schema:
            type: string
        - name: projName
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DeployAgentRequest"
      responses:
        "202":
          description: Agent deployed successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeploymentResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    get:
      summary: List agent deployments with detailed information
      description: Retrieves detailed deployment information for a specific agent across all environments
      operationId: listAgentDeployments
      parameters:
        - name: agentName
          in: path
          description: Unique name of the agent
          required: true
          schema:
            type: string
        - name: orgName
          in: path
          description: Organization name
          required: true
          schema:
            type: string
        - name: projName
          in: path
          description: Project name
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Map of environment names to deployment details, ordered by deployment pipeline sequence
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeploymentListResponse"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}/projects/{projName}/agents/{agentName}/endpoints:
    get:
      summary: Get agent endpoints for a specific environment
      description: Retrieves endpoint configurations for an agent in a specific environment
      operationId: getAgentEndpoints
      parameters:
        - name: agentName
          in: path
          description: Unique name of the agent
          required: true
          schema:
            type: string
        - name: orgName
          in: path
          description: Organization name
          required: true
          schema:
            type: string
        - name: projName
          in: path
          description: Project name
          required: true
          schema:
            type: string
        - name: environment
          in: query
          description: Environment name
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Map of endpoint names to endpoint configurations
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EndpointsResponse"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}/projects/{projName}/agents/{agentName}/configurations:
    get:
      summary: Get agent configurations for a specific environment
      description: Retrieves configuration settings for an agent in a specific environment
      operationId: getAgentConfigurations
      parameters:
        - name: agentName
          in: path
          description: Unique name of the agent
          required: true
          schema:
            type: string
        - name: orgName
          in: path
          description: Organization name
          required: true
          schema:
            type: string
        - name: projName
          in: path
          description: Project name
          required: true
          schema:
            type: string
        - name: environment
          in: query
          description: Environment name
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Agent configuration details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ConfigurationResponse"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /orgs/{orgName}/projects/{projName}/agents/{agentName}/metrics:
    post:
      summary: Get agent resource metrics
      description: Retrieves CPU and memory usage metrics for an agent in a specific environment over a time range
      operationId: getAgentMetrics
      parameters:
        - name: agentName
          in: path
          description: Unique name of the agent
          required: true
          schema:
            type: string
        - name: orgName
          in: path
          description: Organization name
          required: true
          schema:
            type: string
        - name: projName
          in: path
          description: Project name
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MetricsFilterRequest"
      responses:
        "200":
          description: Resource metrics for the specified agent
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MetricsResponse"
        "400":
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /orgs/{orgName}/projects/{projName}/agents/{agentName}/runtime-logs:
    post:
      summary: Get agent runtime logs with filtering
      description: Retrieves filtered runtime logs for an agent with optional time range, log level, and search filtering
      operationId: filterAgentRuntimeLogs
      parameters:
        - name: agentName
          in: path
          description: Unique name of the agent
          required: true
          schema:
            type: string
        - name: orgName
          in: path
          description: Organization name
          required: true
          schema:
            type: string
        - name: projName
          in: path
          description: Project name
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LogFilterRequest"
      responses:
        "200":
          description: A detailed list of filtered application logs for the specified agent
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LogsResponse"
        "400":
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  # ============================================
  # GATEWAY ENVIRONMENT ENDPOINTS
  # ============================================

  /orgs/{orgName}/environments:
    parameters:
      - name: orgName
        in: path
        required: true
        description: Organization name/handle
        schema:
          type: string
          pattern: '^[a-z0-9-]+$'
          minLength: 1
          maxLength: 64

    get:
      tags:
        - Environments
      summary: List all environments
      description: Retrieve a paginated list of all environments for the organization
      operationId: listEnvironments
      parameters:
        - name: limit
          in: query
          description: Maximum number of results to return
          schema:
            type: integer
            format: int32
            minimum: 1
            maximum: 100
            default: 20
        - name: offset
          in: query
          description: Number of results to skip
          schema:
            type: integer
            format: int32
            minimum: 0
            default: 0
      responses:
        '200':
          description: Successfully retrieved environment list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnvironmentListResponse'
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      tags:
        - Environments
      summary: Create a new environment
      description: |
        Create a new gateway environment for the organization.

        Environment names must be unique within an organization and should be lowercase
        alphanumeric with hyphens (e.g., dev, staging, production).
      operationId: createEnvironment
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateEnvironmentRequest'
      responses:
        '201':
          description: Environment created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GatewayEnvironmentResponse'
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: Conflict - resource already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /orgs/{orgName}/environments/{envID}:
    parameters:
      - name: orgName
        in: path
        required: true
        description: Organization name/handle
        schema:
          type: string
          pattern: '^[a-z0-9-]+$'
          minLength: 1
          maxLength: 64
      - name: envID
        in: path
        required: true
        description: Environment UUID or name
        schema:
          type: string

    get:
      tags:
        - Environments
      summary: Get environment details
      description: Retrieve detailed information about a specific environment
      operationId: getEnvironment
      responses:
        '200':
          description: Successfully retrieved environment
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GatewayEnvironmentResponse'
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Resource not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Environments
      summary: Update environment
      description: |
        Update an existing environment's properties.

        You can update the display name and description. The environment name cannot be changed.
      operationId: updateEnvironment
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateEnvironmentRequest'
      responses:
        '200':
          description: Environment updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GatewayEnvironmentResponse'
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Resource not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Environments
      summary: Delete environment
      description: |
        Soft delete an environment. This will also remove all gateway-environment mappings
        associated with this environment.

        The environment can be restored if needed by contacting support.
      operationId: deleteEnvironment
      responses:
        '204':
          description: Environment deleted successfully
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Resource not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /orgs/{orgName}/environments/{envID}/gateways:
    parameters:
      - name: orgName
        in: path
        required: true
        description: Organization name/handle
        schema:
          type: string
          pattern: '^[a-z0-9-]+$'
          minLength: 1
          maxLength: 64
      - name: envID
        in: path
        required: true
        description: Environment UUID or name
        schema:
          type: string

    get:
      tags:
        - Environments
      summary: Get environment gateways
      description: |
        List all gateways mapped to a specific environment.

        This endpoint returns all gateways that are available in this environment,
        useful for understanding which gateways can be used by agents in this environment.
      operationId: getEnvironmentGateways
      responses:
        '200':
          description: Successfully retrieved gateway list
          content:
            application/json:
              schema:
                type: object
                properties:
                  gateways:
                    type: array
                    items:
                      $ref: '#/components/schemas/GatewayResponse'
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Resource not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ============================================
  # AI GATEWAY ENDPOINTS
  # ============================================

  /orgs/{orgName}/gateways:
    parameters:
      - name: orgName
        in: path
        required: true
        description: Organization name/handle
        schema:
          type: string
          pattern: '^[a-z0-9-]+$'
          minLength: 1
          maxLength: 64

    get:
      tags:
        - Gateways
      summary: List all gateways
      description: |
        Retrieve a paginated list of all gateways for the organization.

        Supports filtering by gateway type, status, and environment.
      operationId: listGateways
      parameters:
        - name: limit
          in: query
          description: Maximum number of results to return
          schema:
            type: integer
            format: int32
            minimum: 1
            maximum: 100
            default: 20
        - name: offset
          in: query
          description: Number of results to skip
          schema:
            type: integer
            format: int32
            minimum: 0
            default: 0
        - name: type
          in: query
          description: Filter by gateway type
          schema:
            type: string
            enum:
              - AI
              - REGULAR
        - name: status
          in: query
          description: Filter by gateway status
          schema:
            type: string
            enum:
              - ACTIVE
              - INACTIVE
              - PROVISIONING
              - ERROR
        - name: environment
          in: query
          description: Filter by environment name
          schema:
            type: string
      responses:
        '200':
          description: Successfully retrieved gateway list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GatewayListResponse'
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      tags:
        - Gateways
      summary: Register a new gateway
      description: |
        Register a new AI gateway with the platform.

        **Gateway Types:**
        - REGULAR: Handles incoming API traffic
        - AI: Handles outgoing LLM/MCP traffic (used for AI agents)

        **Security Note:**
        - Gateway credentials are encrypted before storage
        - Credentials are never returned in API responses
        - Use a strong encryption key configured in GATEWAY_ENCRYPTION_KEY
      operationId: registerGateway
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGatewayRequest'
      responses:
        '201':
          description: Gateway registered successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GatewayResponse'
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: Conflict - resource already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /orgs/{orgName}/gateways/{gatewayID}:
    parameters:
      - name: orgName
        in: path
        required: true
        description: Organization name/handle
        schema:
          type: string
          pattern: '^[a-z0-9-]+$'
          minLength: 1
          maxLength: 64
      - name: gatewayID
        in: path
        required: true
        description: Gateway UUID or name
        schema:
          type: string

    get:
      tags:
        - Gateways
      summary: Get gateway details
      description: |
        Retrieve detailed information about a specific gateway, including mapped environments.

        **Security Note:** Credentials are never returned in the response.
      operationId: getGateway
      responses:
        '200':
          description: Successfully retrieved gateway
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GatewayResponse'
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Resource not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Gateways
      summary: Update gateway
      description: |
        Update an existing gateway's properties.

        **Updatable Fields:**
        - Display name
        - Critical flag
        - Status
        - Adapter configuration
        - Credentials (re-encrypted on update)

        **Immutable Fields:**
        - Gateway name
        - Gateway type
        - VHost
        - Organization
      operationId: updateGateway
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateGatewayRequest'
      responses:
        '200':
          description: Gateway updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GatewayResponse'
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Resource not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Gateways
      summary: Deregister gateway
      description: |
        Soft delete a gateway. This will:
        - Mark the gateway as deleted
        - Remove all gateway-environment mappings
        - Preserve gateway data for audit/recovery

        The gateway can be restored if needed by contacting support.

        **Warning:** This operation will affect all environments using this gateway.
      operationId: deleteGateway
      responses:
        '204':
          description: Gateway deregistered successfully
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Resource not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /orgs/{orgName}/gateways/{gatewayID}/environments:
    parameters:
      - name: orgName
        in: path
        required: true
        description: Organization name/handle
        schema:
          type: string
          pattern: '^[a-z0-9-]+$'
          minLength: 1
          maxLength: 64
      - name: gatewayID
        in: path
        required: true
        description: Gateway UUID or name
        schema:
          type: string

    get:
      tags:
        - Gateway-Environment Mappings
      summary: Get gateway environments
      description: |
        List all environments mapped to a specific gateway.

        This shows which environments can use this gateway for routing traffic.
      operationId: getGatewayEnvironments
      responses:
        '200':
          description: Successfully retrieved environment list
          content:
            application/json:
              schema:
                type: object
                properties:
                  environments:
                    type: array
                    items:
                      $ref: '#/components/schemas/GatewayEnvironmentResponse'
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Resource not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /orgs/{orgName}/gateways/{gatewayID}/environments/{envID}:
    parameters:
      - name: orgName
        in: path
        required: true
        description: Organization name/handle
        schema:
          type: string
          pattern: '^[a-z0-9-]+$'
          minLength: 1
          maxLength: 64
      - name: gatewayID
        in: path
        required: true
        description: Gateway UUID or name
        schema:
          type: string
      - name: envID
        in: path
        required: true
        description: Environment UUID or name
        schema:
          type: string

    post:
      tags:
        - Gateway-Environment Mappings
      summary: Assign gateway to environment
      description: |
        Create a mapping between a gateway and an environment.

        This makes the gateway available for use in the specified environment.
        A gateway can be mapped to multiple environments, and an environment can have
        multiple gateways.
      operationId: assignGatewayToEnvironment
      responses:
        '201':
          description: Mapping created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GatewayResponse'
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Resource not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: Mapping already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Gateway-Environment Mappings
      summary: Remove gateway from environment
      description: |
        Remove the mapping between a gateway and an environment.

        This makes the gateway unavailable in the specified environment.

        **Warning:** If agents in this environment are using this gateway, they may
        experience routing failures after this operation.
      operationId: removeGatewayFromEnvironment
      responses:
        '204':
          description: Mapping removed successfully
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Gateway, environment, or mapping not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /orgs/{orgName}/gateways/{gatewayID}/health:
    parameters:
      - name: orgName
        in: path
        required: true
        description: Organization name/handle
        schema:
          type: string
          pattern: '^[a-z0-9-]+$'
          minLength: 1
          maxLength: 64
      - name: gatewayID
        in: path
        required: true
        description: Gateway UUID or name
        schema:
          type: string

    get:
      tags:
        - Health
      summary: Check gateway health
      description: |
        Perform a health check on the gateway by communicating with it via the configured adapter.

        This endpoint will:
        - Verify connectivity to the gateway
        - Check gateway operational status
        - Measure response time
        - Return detailed health information
      operationId: checkGatewayHealth
      responses:
        '200':
          description: Health check completed (status in response body)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthStatusResponse'
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Resource not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /orgs/{orgName}/gateways/{gatewayID}/tokens:
    parameters:
      - name: orgName
        in: path
        required: true
        description: Organization name/handle
        schema:
          type: string
          pattern: '^[a-z0-9-]+$'
          minLength: 1
          maxLength: 64
      - name: gatewayID
        in: path
        required: true
        description: Gateway UUID or name
        schema:
          type: string

    post:
      tags:
        - Gateway Tokens
      summary: Rotate gateway token
      description: |
        Generate a new authentication token for the gateway and invalidate the old one.

        **Security Note:**
        - The new token is only returned once in this response
        - Store the token securely - it cannot be retrieved later
        - The old token will be immediately invalidated
        - Update your gateway configuration with the new token

        **Use Cases:**
        - Regular token rotation for security compliance
        - Token compromise recovery
        - Periodic security maintenance
      operationId: rotateGatewayToken
      responses:
        '200':
          description: Token rotated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GatewayTokenResponse'
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Gateway not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /orgs/{orgName}/gateways/{gatewayID}/tokens/{tokenID}:
    parameters:
      - name: orgName
        in: path
        required: true
        description: Organization name/handle
        schema:
          type: string
          pattern: '^[a-z0-9-]+$'
          minLength: 1
          maxLength: 64
      - name: gatewayID
        in: path
        required: true
        description: Gateway UUID or name
        schema:
          type: string
      - name: tokenID
        in: path
        required: true
        description: Token identifier to revoke
        schema:
          type: string

    delete:
      tags:
        - Gateway Tokens
      summary: Revoke gateway token
      description: |
        Revoke a specific gateway authentication token.

        **Security Note:**
        - The token will be immediately invalidated
        - Any gateway using this token will lose authentication
        - This action cannot be undone

        **Use Cases:**
        - Emergency token revocation after compromise
        - Decommissioning gateway instances
        - Security incident response
      operationId: revokeGatewayToken
      responses:
        '204':
          description: Token revoked successfully
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - invalid or missing authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Gateway or token not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /orgs/{orgName}/data-planes:
    get:
      summary: List all data planes in an organization
      description: Retrieves all data planes available in the specified organization
      operationId: listDataPlanes
      parameters:
        - name: orgName
          in: path
          description: Organization name
          required: true
          schema:
            type: string
      responses:
        "200":
          description: List of data planes
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DataPlaneListResponse"
        "404":
          description: Organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /orgs/{orgName}/projects/{projName}/deployment-pipeline:
    get:
      summary: Get deployment pipeline for a project
      description: Retrieves the deployment pipeline configuration for the specified project within an organization
      operationId: getDeploymentPipeline
      parameters:
        - name: orgName
          in: path
          description: Organization name
          required: true
          schema:
            type: string
        - name: projName
          in: path
          description: Project name
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Deployment pipeline details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeploymentPipelineResponse"
        "404":
          description: Project not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}/projects/{projName}/agents/{agentName}/traces:
    get:
      summary: List traces for an agent
      description: |
        Retrieves a paginated list of traces for the specified agent with optional filtering.
        Note: If either startTime or endTime is provided, both must be provided together.
        Both timestamps must be in RFC3339 format (e.g., 2025-12-20T10:00:00Z).
      operationId: listTraces
      parameters:
        - name: orgName
          in: path
          description: Organization name
          required: true
          schema:
            type: string
        - name: projName
          in: path
          description: Project name
          required: true
          schema:
            type: string
        - name: agentName
          in: path
          description: Agent name
          required: true
          schema:
            type: string
        - name: environment
          in: query
          description: Environment name (e.g., Development, Production)
          required: true
          schema:
            type: string
          example: Development
        - name: limit
          in: query
          description: Maximum number of traces to return
          required: false
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
        - name: offset
          in: query
          description: Number of traces to skip
          required: false
          schema:
            type: integer
            default: 0
            minimum: 0
        - name: startTime
          in: query
          description: |
            Filter traces starting from this time (RFC3339 format, e.g., 2025-12-20T10:00:00Z).
            Must be provided together with endTime.
          required: false
          schema:
            type: string
            format: date-time
          example: "2025-12-20T10:00:00Z"
        - name: endTime
          in: query
          description: |
            Filter traces up to this time (RFC3339 format, e.g., 2025-12-20T10:00:00Z).
            Must be provided together with startTime.
          required: false
          schema:
            type: string
            format: date-time
          example: "2025-12-20T18:00:00Z"
        - name: sortOrder
          in: query
          description: Sort order for traces
          required: false
          schema:
            type: string
            enum: [asc, desc]
            default: desc
      responses:
        "200":
          description: List of traces
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TraceOverviewResponse"
        "400":
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}/projects/{projName}/agents/{agentName}/traces/export:
    get:
      summary: Export traces with full span details
      description: |
        Retrieves complete trace objects including all spans and their attributes for the specified agent.
        Designed for exporting trace data for analysis or archival. Returns full trace details with all spans.
        Note: If either startTime or endTime is provided, both must be provided together.
        Both timestamps must be in RFC3339 format (e.g., 2025-12-20T10:00:00Z).
      operationId: exportTraces
      parameters:
        - name: orgName
          in: path
          description: Organization name
          required: true
          schema:
            type: string
        - name: projName
          in: path
          description: Project name
          required: true
          schema:
            type: string
        - name: agentName
          in: path
          description: Agent name
          required: true
          schema:
            type: string
        - name: environment
          in: query
          description: Environment name (e.g., Development, Production)
          required: true
          schema:
            type: string
          example: Development
        - name: limit
          in: query
          description: Maximum number of traces to export (capped at 1000)
          required: false
          schema:
            type: integer
            default: 100
            minimum: 1
            maximum: 1000
        - name: offset
          in: query
          description: Number of traces to skip
          required: false
          schema:
            type: integer
            default: 0
            minimum: 0
        - name: startTime
          in: query
          description: |
            Filter traces starting from this time (RFC3339 format, e.g., 2025-12-20T10:00:00Z).
            Must be provided together with endTime.
          required: false
          schema:
            type: string
            format: date-time
          example: "2025-12-20T10:00:00Z"
        - name: endTime
          in: query
          description: |
            Filter traces up to this time (RFC3339 format, e.g., 2025-12-20T10:00:00Z).
            Must be provided together with startTime.
          required: false
          schema:
            type: string
            format: date-time
          example: "2025-12-20T18:00:00Z"
        - name: sortOrder
          in: query
          description: Sort order for traces
          required: false
          schema:
            type: string
            enum: [asc, desc]
            default: desc
      responses:
        "200":
          description: Complete trace data with all spans
          headers:
            Content-Disposition:
              description: Suggests a filename for the downloaded export
              schema:
                type: string
                example: "attachment; filename=traces-export-20260116-120000.json"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TraceExportResponse"
        "400":
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}/projects/{projName}/agents/{agentName}/trace/{traceId}:
    get:
      summary: Get trace details
      description: Retrieves detailed information about a specific trace including all spans
      operationId: getTrace
      parameters:
        - name: orgName
          in: path
          description: Organization name
          required: true
          schema:
            type: string
        - name: projName
          in: path
          description: Project name
          required: true
          schema:
            type: string
        - name: agentName
          in: path
          description: Agent name
          required: true
          schema:
            type: string
        - name: traceId
          in: path
          description: Trace ID
          required: true
          schema:
            type: string
        - name: environment
          in: query
          description: Environment name (e.g., Development, Production)
          required: true
          schema:
            type: string
          example: Development
      responses:
        "200":
          description: Trace details with all spans
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TraceResponse"
        "400":
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Trace not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /orgs/{orgName}/projects/{projName}/agents/{agentName}/token:
    post:
      summary: Generate authentication token for an agent
      description: |
        Generates a signed JWT token for an external agent to authenticate API requests.
        The token includes claims for component, environment, organization, and project identifiers.
      operationId: generateAgentToken
      parameters:
        - name: orgName
          in: path
          required: true
          schema:
            type: string
          description: Organization name
        - name: projName
          in: path
          required: true
          schema:
            type: string
          description: Project name
        - name: agentName
          in: path
          required: true
          schema:
            type: string
          description: Agent name
        - name: environment
          in: query
          required: false
          schema:
            type: string
          description: Environment name (defaults to configured default if not provided)
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TokenRequest"
      responses:
        "200":
          description: Token generated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokenResponse"
        "400":
          description: Invalid request (e.g., invalid expiry duration)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Agent, project, or organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /auth/external/jwks.json:
    servers:
      - url: /
        description: Served from root path (not /api/v1)
    get:
      summary: Get JSON Web Key Set (JWKS)
      description: |
        Returns the public keys used to verify JWT signatures.
        This endpoint is public and does not require authentication.
        Clients can use these keys to verify tokens issued by the service.
      operationId: getJWKS
      responses:
        "200":
          description: JWKS retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JWKS"
        "500":
          description: Failed to retrieve JWKS
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /repositories/branches:
    post:
      summary: List branches for a repository
      description: |
        Returns a list of branches for the specified public repository.
        Currently supports GitHub repositories only.
      operationId: listRepositoryBranches
      parameters:
        - name: limit
          in: query
          description: Maximum number of results to return (default 30, max 100)
          required: false
          schema:
            type: integer
            default: 30
            minimum: 1
            maximum: 100
        - name: offset
          in: query
          description: Number of results to skip for pagination (default 0)
          required: false
          schema:
            type: integer
            default: 0
            minimum: 0
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ListBranchesRequest"
      responses:
        "200":
          description: List of branches
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ListBranchesResponse"
        "400":
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Repository not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "429":
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /repositories/commits:
    post:
      summary: List commits for a repository
      description: |
        Returns a list of commits for the specified public repository.
        Currently supports GitHub repositories only.
      operationId: listRepositoryCommits
      parameters:
        - name: limit
          in: query
          description: Maximum number of results to return (default 30, max 100)
          required: false
          schema:
            type: integer
            default: 30
            minimum: 1
            maximum: 100
        - name: offset
          in: query
          description: Number of results to skip for pagination (default 0)
          required: false
          schema:
            type: integer
            default: 0
            minimum: 0
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ListCommitsRequest"
      responses:
        "200":
          description: List of commits
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ListCommitsResponse"
        "400":
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Repository not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "429":
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

components:
  schemas:
    CreateOrganizationRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          description: Name of the organization

    CreateProjectRequest:
      type: object
      required:
        - name
        - deploymentPipeline
        - displayName
      properties:
        name:
          type: string
          description: Name of the project
        displayName:
          type: string
          description: Display name of the project
        description:
          type: string
          description: Description of the project
        deploymentPipeline:
          type: string

    Provisioning:
      type: object
      required:
        - type
      properties:
        type:
          type: string
          enum: [internal]
          description: Type of provisioning
        repository:
          $ref: "#/components/schemas/RepositoryConfig"

    AgentType:
      type: object
      required:
        - type
      properties:
        type:
          type: string
          description: Type of the agent
        subType:
          type: string
          description: Sub-type of the agent

    BuildpackConfig:
      type: object
      required:
        - language
      properties:
        language:
          type: string
          description: Programming language for the buildpack
        languageVersion:
          type: string
          description: Version of the language runtime (optional, not needed for languages like Ballerina)
        runCommand:
          type: string
          description: Command to run the application (optional, not needed for languages like Ballerina)

    DockerConfig:
      type: object
      required:
        - dockerfilePath
      properties:
        dockerfilePath:
          type: string
          description: Path to the Dockerfile relative to the repository root

    BuildpackBuild:
      type: object
      required:
        - type
        - buildpack
      properties:
        type:
          type: string
          enum: [buildpack]
          description: Build method for the component
        buildpack:
          $ref: "#/components/schemas/BuildpackConfig"

    DockerBuild:
      type: object
      required:
        - type
        - docker
      properties:
        type:
          type: string
          enum: [docker]
          description: Build method for the component
        docker:
          $ref: "#/components/schemas/DockerConfig"

    Build:
      oneOf:
        - $ref: "#/components/schemas/BuildpackBuild"
        - $ref: "#/components/schemas/DockerBuild"
      discriminator:
        propertyName: type
        mapping:
          buildpack: "#/components/schemas/BuildpackBuild"
          docker: "#/components/schemas/DockerBuild"

    CreateAgentRequest:
      type: object
      required:
        - name
        - displayName
        - provisioning
        - agentType
      properties:
        name:
          type: string
          description: Unique name of the agent
        displayName:
          type: string
          description: Display name of the agent
        provisioning:
          $ref: "#/components/schemas/Provisioning"
        description:
          type: string
          description: Description of the agent
        agentType:
          $ref: "#/components/schemas/AgentType"
        build:
          $ref: "#/components/schemas/Build"
        configurations:
          $ref: "#/components/schemas/Configurations"
        inputInterface:
          $ref: "#/components/schemas/InputInterface"

    UpdateAgentBasicInfoRequest:
      type: object
      required:
        - displayName
        - description
      properties:
        displayName:
          type: string
          description: Display name of the agent
        description:
          type: string
          description: Description of the agent

    UpdateAgentBuildParametersRequest:
      type: object
      required:
        - provisioning
        - agentType
        - build
        - inputInterface
      properties:
        provisioning:
          $ref: "#/components/schemas/Provisioning"
        agentType:
          $ref: "#/components/schemas/AgentType"
        build:
          $ref: "#/components/schemas/Build"
        inputInterface:
          $ref: "#/components/schemas/InputInterface"

    UpdateAgentResourceConfigsRequest:
      type: object
      required:
        - replicas
        - resources
      properties:
        replicas:
          type: integer
          format: int32
          description: Number of replicas to run
          minimum: 0
          maximum: 10
        resources:
          $ref: "#/components/schemas/ResourceConfig"

    ResourceConfig:
      type: object
      properties:
        requests:
          $ref: "#/components/schemas/ResourceRequests"
        limits:
          $ref: "#/components/schemas/ResourceLimits"

    ResourceRequests:
      type: object
      properties:
        cpu:
          type: string
          description: CPU request (e.g., "100m", "0.5", "1.5")
          pattern: '^[0-9]+(\.[0-9]+)?m?$'
        memory:
          type: string
          description: Memory request (e.g., "256Mi", "1Gi", "512Ki", "2Ti")
          pattern: '^[0-9]+(\.[0-9]+)?(Ki|Mi|Gi|Ti|Pi|Ei)$'

    ResourceLimits:
      type: object
      properties:
        cpu:
          type: string
          description: CPU limit (e.g., "500m", "2", "1.5")
          pattern: '^[0-9]+(\.[0-9]+)?m?$'
        memory:
          type: string
          description: Memory limit (e.g., "512Mi", "2Gi", "1Ti", "256Ki")
          pattern: '^[0-9]+(\.[0-9]+)?(Ki|Mi|Gi|Ti|Pi|Ei)$'

    AgentResourceConfigsResponse:
      type: object
      properties:
        replicas:
          type: integer
          format: int32
          description: Current number of replicas (environment-specific if environment provided, otherwise component default)
        resources:
          $ref: "#/components/schemas/ResourceConfig"
          description: Current resource configurations (environment-specific if environment provided, otherwise component default)
        defaultReplicas:
          type: integer
          format: int32
          description: Component-level default replicas (only populated when environment query parameter is provided)
        defaultResources:
          $ref: "#/components/schemas/ResourceConfig"
          description: Component-level default resources (only populated when environment query parameter is provided)
        isDefaultsOverridden:
          type: boolean
          description: Indicates whether environment-specific overrides exist (only populated when environment query parameter is provided)

    UpdateProjectRequest:
      type: object
      properties:
        displayName:
          type: string
          description: Display name of the project
        description:
          type: string
          description: Description of the project
        deploymentPipeline:
          type: string
      required:
        - displayName
        - description
        - deploymentPipeline
    AgentResponse:
      type: object
      properties:
        uuid:
          type: string
        name:
          type: string
        displayName:
          type: string
        description:
          type: string
        createdAt:
          type: string
          format: date-time
        projectName:
          type: string
        status:
          type: string
          description: Current status of the agent
        provisioning:
          $ref: "#/components/schemas/Provisioning"
        agentType:
          $ref: "#/components/schemas/AgentType"
        configurations:
          $ref: "#/components/schemas/Configurations"
        inputInterface:
          $ref: "#/components/schemas/InputInterface"
        build:
          $ref: "#/components/schemas/Build"
      required:
        - uuid
        - name
        - displayName
        - createdAt
        - projectName
        - description
        - provisioning
        - agentType
    ResourceNameRequest:
      type: object
      properties:
        displayName:
          type: string
          description: Display name of the agent
        resourceType:
          type: string
          description: Type of resource (e.g., agent, project)
        projectName:
          type: string
          description: Name of the project (required if resourceType is agent)
      required:
        - displayName
        - resourceType
    ResourceNameResponse:
      type: object
      properties:
        name:
          type: string
          description: The resource name
        displayName:
          type: string
          description: The display name of the resource
        resourceType:
          type: string
          description: Type of resource (e.g., agent, project)
      required:
        - name
        - displayName
        - resourceType
    AgentListResponse:
      type: object
      properties:
        agents:
          type: array
          items:
            $ref: "#/components/schemas/AgentResponse"
        total:
          type: integer
          description: Total number of agents matching the query
        limit:
          type: integer
        offset:
          type: integer
      required:
        - agents
        - total
        - limit
        - offset
    BuildsListResponse:
      type: object
      properties:
        builds:
          type: array
          items:
            $ref: "#/components/schemas/BuildResponse"
        total:
          type: integer
          description: Total number of builds matching the query
        limit:
          type: integer
        offset:
          type: integer
      required:
        - builds
        - total
        - limit
        - offset
    # Repository Configuration
    RepositoryConfig:
      type: object
      description: Git repository configuration
      required:
        - url
        - branch
        - appPath
      properties:
        url:
          type: string
          description: URL of the git repository
        branch:
          type: string
          description: Branch to use
        appPath:
          type: string
          description: Path within the repository where the source code resides
          pattern: "^/.*"
          example: "/my-agent"
    BuildParameters:
      type: object
      description: Parameters used for the build
      properties:
        repoUrl:
          type: string
          description: Repository URL
        appPath:
          type: string
          description: Path within the repository
        branch:
          type: string
          description: Branch name
        commitId:
          type: string
          description: Commit ID
        language:
          type: string
          description: Programming language
        languageVersion:
          type: string
          description: Language version
        runCommand:
          type: string
          description: Command to run the application
      required:
        - commitId
        - branch
        - repoUrl
        - appPath
        - language
        - languageVersion
        - runCommand
    BuildResponse:
      type: object
      properties:
        buildId:
          type: string
        buildName:
          type: string
        projectName:
          type: string
        agentName:
          type: string
        startedAt:
          type: string
          format: date-time
        endedAt:
          type: string
          format: date-time
        imageId:
          type: string
        status:
          type: string
          enum: [BuildInProgress, BuildTriggered, BuildCompleted]
        buildParameters:
          $ref: "#/components/schemas/BuildParameters"
      required:
        - buildName
        - projectName
        - agentName
        - startedAt
        - buildParameters
    LogEntry:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        log:
          type: string
        logLevel:
          type: string
          enum: [INFO, WARN, ERROR, DEBUG]
      required:
        - timestamp
        - log
        - logLevel
    LogsResponse:
      type: object
      properties:
        logs:
          type: array
          items:
            $ref: "#/components/schemas/LogEntry"
        totalCount:
          type: integer
        tookMs:
          type: number
          format: float
      required:
        - logs
        - totalCount
        - tookMs
    BuildStep:
      type: object
      properties:
        type:
          type: string
          description: Type of build step
          enum:
            [
              BuildInitiated,
              BuildTriggered,
              BuildRunning,
              BuildCompleted,
              WorkloadUpdated,
            ]
        status:
          type: string
          description: Status of the build step
          enum: [Succeeded, Failed, Running, Pending]
        message:
          type: string
          description: Human-readable message about the step
        startedAt:
          type: string
          format: date-time
          description: Timestamp when the step occurred
        finishedAt:
          type: string
          format: date-time
          description: Timestamp when the step finished
      required:
        - type
        - status
        - message

    BuildDetailsResponse:
      allOf:
        - $ref: "#/components/schemas/BuildResponse"
        - type: object
          properties:
            percent:
              type: number
              format: float
              description: Build completion percentage (0-100)
              minimum: 0
              maximum: 100
            steps:
              type: array
              description: Array of build steps with their status
              items:
                $ref: "#/components/schemas/BuildStep"
            durationSeconds:
              type: integer
              description: Build duration in seconds
              minimum: 0
            inputInterface:
              $ref: "#/components/schemas/InputInterface"

    # Deployment Schemas
    DeployAgentRequest:
      type: object
      properties:
        imageId:
          type: string
          description: Container image ID to deploy
        env:
          type: array
          description: Environment variables
          items:
            $ref: "#/components/schemas/EnvironmentVariable"
      required:
        - imageId
    Configurations:
      type: object
      properties:
        env:
          type: array
          description: Environment variables
          items:
            $ref: "#/components/schemas/EnvironmentVariable"
    EnvironmentVariable:
      type: object
      required:
        - key
        - value
      properties:
        key:
          type: string
        value:
          type: string
    InputInterface:
      type: object
      description: Endpoint configurations
      required:
        - type
      properties:
        type:
          type: string
          description: Type of the endpoint (e.g., HTTP)
        port:
          type: integer
          description: Port number
          minimum: 1
          maximum: 65535
        schema:
          $ref: "#/components/schemas/InputInterfaceSchema"
        basePath:
          type: string
          description: Base path for the endpoint
    InputInterfaceSchema:
      type: object
      properties:
        path:
          type: string
          description: Path to OpenAPI schema file
          pattern: "^/.*"
          example: "/openapi.yaml"
      required:
        - path
    EndpointSchema:
      type: object
      required:
        - content
      properties:
        content:
          type: string
          description: Schema content
    DeploymentResponse:
      type: object
      properties:
        agentName:
          type: string
        projectName:
          type: string
        imageId:
          type: string
        environment:
          type: string
      required:
        - agentName
        - projectName
        - imageId
        - environment

    DeploymentEndpoint:
      type: object
      properties:
        name:
          type: string
          description: Name of the endpoint
        url:
          type: string
          description: URL of the endpoint
        visibility:
          type: string
          description: Visibility level of the endpoint
          enum: [Public, Private, Internal]
      required:
        - name
        - url
        - visibility

    DeploymentDetailsResponse:
      type: object
      properties:
        imageId:
          type: string
          description: Container image ID
        status:
          type: string
          description: Deployment status
        lastDeployed:
          type: string
          format: date-time
          description: Timestamp of last deployment
        endpoints:
          type: array
          description: List of deployment endpoints
          items:
            $ref: "#/components/schemas/DeploymentEndpoint"
        environmentDisplayName:
          type: string
          description: Environment display name
        promotionTargetEnvironment:
          type: object
          description: Promotion target environment details
          properties:
            name:
              type: string
              description: name of the promotion target environment
            displayName:
              type: string
              description: Human-readable display name of the promotion target environment
          required:
            - name
            - displayName
      required:
        - imageId
        - status
        - lastDeployed
        - endpoints
    DeploymentListResponse:
      type: object
      additionalProperties:
        $ref: "#/components/schemas/DeploymentDetailsResponse"
      description: Map of environment names to deployment details. Keys are ordered according to deployment pipeline sequence.

    EnvironmentObject:
      type: object
      properties:
        name:
          type: string
          description: Environment name
        displayName:
          type: string
          description: Human-readable display name of the environment
      required:
        - name
        - displayName

    EndpointConfiguration:
      type: object
      properties:
        url:
          type: string
          description: URL of the endpoint
        endpointName:
          type: string
          description: Name of the endpoint
        schema:
          $ref: "#/components/schemas/EndpointSchema"
        visibility:
          type: string
          description: Visibility level of the endpoint
      required:
        - url
        - endpointName
        - schema
        - visibility

    EndpointsResponse:
      type: object
      additionalProperties:
        $ref: "#/components/schemas/EndpointConfiguration"
      description: Map of endpoint names to endpoint configurations

    Environment:
      type: object
      properties:
        uuid:
          type: string
          description: Unique identifier of the environment
        name:
          type: string
          description: Name of the environment
        dataplaneRef:
          type: string
          description: Reference to the data plane for the environment
        displayName:
          type: string
          description: Human-readable display name
        isProduction:
          type: boolean
          description: Whether this is a production environment
        dnsPrefix:
          type: string
          description: DNS prefix for the environment
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the environment was created
      required:
        - uuid
        - name
        - dataplaneRef
        - isProduction
        - createdAt

    EnvironmentListResponse:
      type: array
      items:
        $ref: "#/components/schemas/Environment"
      description: List of environments

    DataPlane:
      type: object
      properties:
        name:
          type: string
          description: Name of the data plane
        displayName:
          type: string
          description: Human-readable display name
        description:
          type: string
          description: Description of the data plane
        orgName:
          type: string
          description: Organization name
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the data plane was created
      required:
        - name
        - displayName
        - description
        - orgName
        - createdAt

    DataPlaneListResponse:
      type: array
      items:
        $ref: "#/components/schemas/DataPlane"
      description: List of data planes

    DeploymentPipelineResponse:
      type: object
      properties:
        name:
          type: string
          description: Name of the deployment pipeline
        displayName:
          type: string
          description: Human-readable display name
        description:
          type: string
          description: Description of the deployment pipeline
        orgName:
          type: string
          description: Organization name
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the pipeline was created
        promotionPaths:
          type: array
          description: List of promotion paths in the pipeline
          items:
            $ref: "#/components/schemas/PromotionPath"
      required:
        - name
        - displayName
        - description
        - orgName
        - createdAt
        - promotionPaths

    DeploymentPipelineListResponse:
      type: object
      properties:
        deploymentPipelines:
          type: array
          items:
            $ref: "#/components/schemas/DeploymentPipelineResponse"
        total:
          type: integer
          description: Total number of deployment pipelines matching the query
        limit:
          type: integer
        offset:
          type: integer
      required:
        - deploymentPipelines
        - total
        - limit
        - offset

    PromotionPath:
      type: object
      properties:
        sourceEnvironmentRef:
          type: string
          description: Reference to the source environment
        targetEnvironmentRefs:
          type: array
          description: List of target environment references
          items:
            $ref: "#/components/schemas/TargetEnvironmentRef"
      required:
        - sourceEnvironmentRef
        - targetEnvironmentRefs

    TargetEnvironmentRef:
      type: object
      properties:
        name:
          type: string
          description: Name of the target environment
      required:
        - name

    ConfigurationResponse:
      type: object
      properties:
        projectName:
          type: string
          description: Name of the project
        agentName:
          type: string
          description: Name of the agent
        environment:
          type: string
          description: Environment name
        configurations:
          type: array
          description: List of configuration key-value pairs
          items:
            $ref: "#/components/schemas/ConfigurationItem"
      required:
        - projectName
        - agentName
        - environment
        - configurations

    ConfigurationItem:
      type: object
      properties:
        key:
          type: string
          description: Configuration key
        value:
          type: string
          description: Configuration value
      required:
        - key
        - value

    OrganizationResponse:
      type: object
      properties:
        name:
          type: string
          description: Name of the organization
        displayName:
          type: string
          description: Display name of the organization
        description:
          type: string
          description: Description of the organization
        namespace:
          type: string
          description: Namespace of the organization
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the organization was created
      required:
        - name
        - createdAt
        - displayName
        - description
        - namespace
    OrganizationListItem:
      type: object
      properties:
        name:
          type: string
          description: Name of the organization
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the organization was created
      required:
        - name
        - createdAt

    OrganizationListResponse:
      type: object
      properties:
        organizations:
          type: array
          items:
            $ref: "#/components/schemas/OrganizationListItem"
        total:
          type: integer
          description: Total number of organizations matching the query
        limit:
          type: integer
        offset:
          type: integer
      required:
        - organizations
        - total
        - limit
        - offset

    ProjectResponse:
      type: object
      properties:
        uuid:
          type: string
        name:
          type: string
          description: Name of the project
        orgName:
          type: string
          description: Name of the organization
        displayName:
          type: string
          description: Display name of the project
        description:
          type: string
          description: Description of the project
        deploymentPipeline:
          type: string
          description: Deployment pipeline associated with the project
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the project was created
      required:
        - uuid
        - name
        - orgName
        - displayName
        - description
        - deploymentPipeline
        - createdAt

    ProjectListItem:
      type: object
      properties:
        uuid:
          type: string
        name:
          type: string
          description: Name of the project
        orgName:
          type: string
          description: Name of the organization
        displayName:
          type: string
          description: Display name of the project
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the project was created
      required:
        - uuid
        - name
        - orgName
        - displayName
        - createdAt

    ProjectListResponse:
      type: object
      properties:
        projects:
          type: array
          items:
            $ref: "#/components/schemas/ProjectListItem"
        total:
          type: integer
          description: Total number of projects matching the query
        limit:
          type: integer
        offset:
          type: integer
      required:
        - projects
        - total
        - limit
        - offset

    ErrorResponse:
      type: object
      properties:
        message:
          type: string
          description: Human-readable error message
        description:
          type: string
          description: Error description
        additionalData:
          type: object
          additionalProperties: true
      required:
        - message

    AgentTypeSubtype:
      type: object
      properties:
        name:
          type: string
          description: Name of the agent subtype
        displayName:
          type: string
          description: Display name of the agent subtype
        description:
          type: string
          description: Description of the agent subtype
      required:
        - name
        - displayName
        - description

    AgentTypeResponse:
      type: object
      properties:
        name:
          type: string
          description: Name of the agent type
        displayName:
          type: string
          description: Display name of the agent type
        description:
          type: string
          description: Description of the agent type
        subtypes:
          type: array
          items:
            $ref: "#/components/schemas/AgentTypeSubtype"
          description: List of subtypes for this agent type
      required:
        - name
        - displayName
        - description
        - subtypes

    TraceOverviewResponse:
      type: object
      properties:
        traces:
          type: array
          items:
            $ref: "#/components/schemas/TraceOverview"
          description: List of trace overviews
        totalCount:
          type: integer
          description: Total number of traces matching the query
      required:
        - traces
        - totalCount

    TraceExportResponse:
      type: object
      properties:
        traces:
          type: array
          items:
            $ref: "#/components/schemas/FullTrace"
          description: List of complete trace objects with all span details
        totalCount:
          type: integer
          description: Total number of traces available for export
      required:
        - traces
        - totalCount

    FullTrace:
      type: object
      properties:
        traceId:
          type: string
          description: Unique identifier for the trace
        rootSpanId:
          type: string
          description: ID of the root span in the trace
        rootSpanName:
          type: string
          description: Name of the root span
        rootSpanKind:
          type: string
          description: Semantic kind of the root span (llm, tool, agent, etc.)
        startTime:
          type: string
          format: date-time
          description: Trace start time
        endTime:
          type: string
          format: date-time
          description: Trace end time
        durationInNanos:
          type: integer
          format: int64
          description: Total trace duration in nanoseconds
        spanCount:
          type: integer
          description: Number of spans in this trace
        tokenUsage:
          $ref: "#/components/schemas/TokenUsage"
        status:
          $ref: "#/components/schemas/TraceStatus"
        input:
          description: Input data from the root span
          nullable: true
        output:
          description: Output data from the root span
          nullable: true
        spans:
          type: array
          items:
            $ref: "#/components/schemas/Span"
          description: All spans in the trace with complete details
      required:
        - traceId
        - rootSpanId
        - rootSpanName
        - startTime
        - endTime
        - spans

    TraceOverview:
      type: object
      properties:
        traceId:
          type: string
          description: Unique identifier for the trace
        rootSpanId:
          type: string
          description: ID of the root span in the trace
        rootSpanName:
          type: string
          description: Name of the root span
        rootSpanKind:
          type: string
          description: Semantic kind of the root span (llm, tool, embedding, etc.)
        startTime:
          type: string
          format: date-time
          description: Trace start time
        endTime:
          type: string
          format: date-time
          description: Trace end time
        durationInNanos:
          type: integer
          format: int64
          description: Trace duration in nanoseconds
        spanCount:
          type: integer
          description: Number of spans in the trace
        tokenUsage:
          $ref: "#/components/schemas/TokenUsage"
        status:
          $ref: "#/components/schemas/TraceStatus"
        input:
          type: string
          description: Input from root span's traceloop.entity.input
        output:
          type: string
          description: Output from root span's traceloop.entity.output
      required:
        - traceId
        - rootSpanId
        - rootSpanName
        - startTime
        - endTime
        - durationInNanos
        - spanCount

    TokenUsage:
      type: object
      properties:
        inputTokens:
          type: integer
          description: Number of input tokens consumed
        outputTokens:
          type: integer
          description: Number of output tokens generated
        totalTokens:
          type: integer
          description: Total tokens (input + output)
      required:
        - inputTokens
        - outputTokens
        - totalTokens

    TraceStatus:
      type: object
      properties:
        errorCount:
          type: integer
          description: Number of spans with errors (0 means no errors)
      required:
        - errorCount

    TraceResponse:
      type: object
      properties:
        spans:
          type: array
          items:
            $ref: "#/components/schemas/Span"
          description: List of spans in the trace
        totalCount:
          type: integer
          description: Total number of spans in the trace
        tokenUsage:
          $ref: "#/components/schemas/TokenUsage"
        status:
          $ref: "#/components/schemas/TraceStatus"
      required:
        - spans
        - totalCount

    Span:
      type: object
      properties:
        traceId:
          type: string
          description: Trace ID this span belongs to
        spanId:
          type: string
          description: Unique span identifier
        parentSpanId:
          type: string
          description: Parent span ID (if this is a child span)
        name:
          type: string
          description: Span name/operation
        service:
          type: string
          description: Service name
        kind:
          type: string
          description: Span kind (CLIENT, SERVER, INTERNAL, etc.)
        startTime:
          type: string
          format: date-time
          description: Span start time
        endTime:
          type: string
          format: date-time
          description: Span end time
        durationInNanos:
          type: integer
          format: int64
          description: Span duration in nanoseconds
        status:
          type: string
          description: Span status
        attributes:
          type: object
          additionalProperties: true
          description: Raw span attributes
        resource:
          type: object
          additionalProperties: true
          description: Resource attributes
        ampAttributes:
          $ref: "#/components/schemas/AmpAttributes"
      required:
        - traceId
        - spanId
        - name
        - service
        - startTime
        - durationInNanos

    AmpAttributes:
      type: object
      properties:
        kind:
          type: string
          description: Semantic span type (llm, tool, embedding, retriever, agent, etc.)
        input:
          oneOf:
            - type: array
              items:
                $ref: "#/components/schemas/PromptMessage"
            - type: array
              items:
                type: string
            - type: string
          description: Input data - varies by span kind ([]PromptMessage for LLM, []string for embedding, string for tool/agent)
        output:
          oneOf:
            - type: array
              items:
                $ref: "#/components/schemas/PromptMessage"
            - type: string
          description: Output data - varies by span kind ([]PromptMessage for LLM, string for tool/agent)
        status:
          $ref: "#/components/schemas/SpanStatus"
        data:
          oneOf:
            - $ref: "#/components/schemas/LLMData"
            - $ref: "#/components/schemas/ToolData"
            - $ref: "#/components/schemas/EmbeddingData"
            - $ref: "#/components/schemas/RetrieverData"
            - $ref: "#/components/schemas/AgentData"
          description: Kind-specific data based on the span type
      required:
        - kind

    LLMData:
      type: object
      properties:
        tools:
          type: array
          items:
            $ref: "#/components/schemas/ToolDefinition"
          description: Available tools/functions
        model:
          type: string
          description: Model name
        vendor:
          type: string
          description: LLM vendor/provider (e.g., openai, anthropic)
        temperature:
          type: number
          format: float
          description: Temperature parameter
        tokenUsage:
          $ref: "#/components/schemas/LLMTokenUsage"

    ToolData:
      type: object
      properties:
        name:
          type: string
          description: Tool/function name

    EmbeddingData:
      type: object
      properties:
        model:
          type: string
          description: Embedding model name
        vendor:
          type: string
          description: Embedding vendor/provider
        tokenUsage:
          $ref: "#/components/schemas/LLMTokenUsage"

    RetrieverData:
      type: object
      properties:
        vectorDB:
          type: string
          description: Vector database system (e.g., chroma, pinecone)
        topK:
          type: integer
          description: Number of top results requested

    AgentData:
      type: object
      properties:
        name:
          type: string
          description: Agent name
        tools:
          type: array
          items:
            type: string
          description: Available tool names for the agent
        model:
          type: string
          description: Model used by the agent
        framework:
          type: string
          description: Agent framework (e.g., strands-agents, langchain)
        systemPrompt:
          type: string
          description: System prompt for the agent
        tokenUsage:
          $ref: "#/components/schemas/LLMTokenUsage"

    PromptMessage:
      type: object
      properties:
        role:
          type: string
          enum: [system, user, assistant, tool]
          description: Message role
        content:
          type: string
          description: Message content
        toolCalls:
          type: array
          items:
            $ref: "#/components/schemas/ToolCall"
          description: Tool calls made by assistant
      required:
        - role

    ToolCall:
      type: object
      properties:
        id:
          type: string
          description: Tool call ID
        name:
          type: string
          description: Function/tool name
        arguments:
          type: string
          description: JSON arguments for the tool
      required:
        - id
        - name
        - arguments

    MetricsFilterRequest:
      type: object
      description: Request body for filtering and retrieving agent resource metrics
      required:
        - environmentName
        - startTime
        - endTime
      properties:
        environmentName:
          type: string
          description: Environment name
        startTime:
          type: string
          format: string
          description: Start time for metrics filtering (RFC3339 format)
        endTime:
          type: string
          format: string
          description: End time for metrics filtering (RFC3339 format)

    MetricsResponse:
      type: object
      description: Resource metrics response containing CPU and memory usage data
      properties:
        cpuUsage:
          type: array
          description: CPU usage metrics over time
          items:
            $ref: "#/components/schemas/MetricDataPoint"
        cpuRequests:
          type: array
          description: CPU request values over time
          items:
            $ref: "#/components/schemas/MetricDataPoint"
        cpuLimits:
          type: array
          description: CPU limit values over time
          items:
            $ref: "#/components/schemas/MetricDataPoint"
        memory:
          type: array
          description: Memory usage in bytes over time
          items:
            $ref: "#/components/schemas/MetricDataPoint"
        memoryRequests:
          type: array
          description: Memory request values in bytes over time
          items:
            $ref: "#/components/schemas/MetricDataPoint"
        memoryLimits:
          type: array
          description: Memory limit values in bytes over time
          items:
            $ref: "#/components/schemas/MetricDataPoint"
      required:
        - cpuUsage
        - cpuRequests
        - cpuLimits
        - memory
        - memoryRequests
        - memoryLimits

    MetricDataPoint:
      type: object
      description: A single metric data point with timestamp and value
      properties:
        time:
          type: string
          format: string
          description: Timestamp of the metric data point in RFC3339 format
        value:
          type: number
          format: double
          description: Metric value (CPU as decimal cores, memory as bytes)
      required:
        - time
        - value

    LogFilterRequest:
      type: object
      description: Request body for filtering and retrieving application logs
      required:
        - environmentName
        - startTime
        - endTime
      properties:
        environmentName:
          type: string
          description: Environment name
        startTime:
          type: string
          format: string
          description: Start time for log filtering (RFC3339 format). Must be provided with endTime.
        endTime:
          type: string
          format: string
          description: End time for log filtering (RFC3339 format). Must be provided with startTime.
        limit:
          type: integer
          description: Maximum number of log entries to return
          minimum: 1
          maximum: 10000
        sortOrder:
          type: string
          description: Sort order of the logs
          enum: [asc, desc]
        logLevels:
          type: array
          description: Array of log levels to filter by
          items:
            type: string
            enum: [DEBUG, INFO, WARN, ERROR]
        searchPhrase:
          type: string
          description: Search phrase to filter logs by content

    ToolDefinition:
      type: object
      properties:
        name:
          type: string
          description: Function name
        description:
          type: string
          description: Function description
        parameters:
          type: string
          description: JSON schema of parameters
      required:
        - name

    SpanStatus:
      type: object
      properties:
        error:
          type: boolean
          description: Whether the span has an error
        errorType:
          type: string
          description: Type of error if present
      required:
        - error

    LLMTokenUsage:
      type: object
      properties:
        inputTokens:
          type: integer
          description: Number of input tokens
        outputTokens:
          type: integer
          description: Number of output tokens
        cacheReadInputTokens:
          type: integer
          description: Number of cached input tokens read
        totalTokens:
          type: integer
          description: Total tokens used
      required:
        - inputTokens
        - outputTokens
        - totalTokens

    TokenRequest:
      type: object
      properties:
        expires_in:
          type: string
          description: |
            Optional token expiry duration in Go duration format (e.g., "720h" for 30 days, "8760h" for 1 year).
            If not provided, the default expiry from configuration is used.
          example: "720h"

    TokenResponse:
      type: object
      required:
        - token
        - expires_at
        - issued_at
        - token_type
      properties:
        token:
          type: string
          description: The signed JWT token
          example: "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImtleS0xIn0..."
        expires_at:
          type: integer
          format: int64
          description: Unix timestamp when the token expires
          example: 1735718400
        issued_at:
          type: integer
          format: int64
          description: Unix timestamp when the token was issued
          example: 1704182400
        token_type:
          type: string
          description: Type of token (always "Bearer")
          example: "Bearer"

    JWKS:
      type: object
      required:
        - keys
      properties:
        keys:
          type: array
          description: Array of JSON Web Keys
          items:
            $ref: "#/components/schemas/JWK"

    JWK:
      type: object
      required:
        - kty
        - alg
        - use
        - kid
        - n
        - e
      properties:
        kty:
          type: string
          description: Key type (RSA)
          example: "RSA"
        alg:
          type: string
          description: Algorithm (RS256)
          example: "RS256"
        use:
          type: string
          description: Intended use (sig for signature)
          example: "sig"
        kid:
          type: string
          description: Key ID
          example: "key-1"
        n:
          type: string
          description: RSA modulus (Base64urlUInt-encoded)
          example: "xGOr-H7A-PWGfXengPm..."
        e:
          type: string
          description: RSA exponent (Base64urlUInt-encoded)
          example: "AQAB"

    ListBranchesRequest:
      type: object
      description: Request body for listing repository branches
      required:
        - owner
        - repository
      properties:
        owner:
          type: string
          description: Repository owner (organization or user)
          example: "octocat"
        repository:
          type: string
          description: Repository name
          example: "hello-world"
        includeDefault:
          type: boolean
          description: Whether to include default branch information in the response
          default: false
          example: true

    ListBranchesResponse:
      type: object
      description: Response containing list of branches
      required:
        - branches
        - limit
        - offset
      properties:
        branches:
          type: array
          items:
            $ref: "#/components/schemas/Branch"
          description: List of branches
        nextOffset:
          type: integer
          description: Offset to use for fetching the next page (only present when more results are available)
        limit:
          type: integer
          description: Maximum number of results returned
        offset:
          type: integer
          description: Number of results skipped

    Branch:
      type: object
      description: Git branch information
      required:
        - name
        - commitSha
        - isDefault
      properties:
        name:
          type: string
          description: Branch name
          example: "main"
        commitSha:
          type: string
          description: SHA of the latest commit on this branch
          example: "c5b97d5ae6c19d5c5df71a34c7fbeeda2479ccbc"
        isDefault:
          type: boolean
          description: Whether this is the default branch of the repository
          example: true

    ListCommitsRequest:
      type: object
      description: Request body for listing repository commits
      required:
        - owner
        - repo
      properties:
        owner:
          type: string
          description: Repository owner (organization or user)
          example: "octocat"
        repo:
          type: string
          description: Repository name
          example: "hello-world"
        branch:
          type: string
          description: Branch name or SHA to list commits from (defaults to repository's default branch)
          example: "main"
        path:
          type: string
          description: Filter commits affecting this file path
          example: "src/main.go"
        author:
          type: string
          description: Filter commits by author (GitHub username or email)
          example: "octocat"
        since:
          type: string
          format: date-time
          description: Filter commits after this date (RFC3339 format)
          example: "2025-01-01T00:00:00Z"
        until:
          type: string
          format: date-time
          description: Filter commits before this date (RFC3339 format)
          example: "2025-12-31T23:59:59Z"

    ListCommitsResponse:
      type: object
      description: Response containing list of commits
      required:
        - commits
        - limit
        - offset
      properties:
        commits:
          type: array
          items:
            $ref: "#/components/schemas/Commit"
          description: List of commits
        nextOffset:
          type: integer
          description: Offset to use for fetching the next page (only present when more results are available)
        limit:
          type: integer
          description: Maximum number of results returned
        offset:
          type: integer
          description: Number of results skipped

    Commit:
      type: object
      description: Git commit information
      required:
        - sha
        - shortSha
        - message
        - author
        - timestamp
        - isLatest
      properties:
        sha:
          type: string
          description: Full commit SHA
          example: "c5b97d5ae6c19d5c5df71a34c7fbeeda2479ccbc"
        shortSha:
          type: string
          description: Short commit SHA (first 7 characters)
          example: "c5b97d5"
        message:
          type: string
          description: Commit message
          example: "Fix authentication bug"
        author:
          $ref: "#/components/schemas/CommitAuthor"
        timestamp:
          type: string
          format: date-time
          description: Commit timestamp
          example: "2025-01-15T10:30:00Z"
        isLatest:
          type: boolean
          description: Whether this is the latest commit on the branch
          example: true

    CommitAuthor:
      type: object
      description: Commit author information
      required:
        - name
        - email
      properties:
        name:
          type: string
          description: Author name
          example: "The Octocat"
        email:
          type: string
          description: Author email
          example: "octocat@github.com"
        avatarUrl:
          type: string
          description: URL to the author's avatar image
          example: "https://avatars.githubusercontent.com/u/583231?v=4"

    # ============================================
    # GATEWAY ENVIRONMENT MANAGEMENT SCHEMAS
    # ============================================

    GatewayEnvironmentResponse:
      type: object
      required:
        - id
        - organizationName
        - name
        - displayName
        - dataplaneRef
        - dnsPrefix
        - isProduction
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          description: Unique identifier for the environment
          example: 550e8400-e29b-41d4-a716-446655440000
        organizationName:
          type: string
          description: Organization UUID
          example: 123e4567-e89b-12d3-a456-426614174000
        name:
          type: string
          description: Unique environment name (lowercase, alphanumeric with hyphens)
          pattern: '^[a-z0-9-]+$'
          maxLength: 64
          example: production
        displayName:
          type: string
          description: Human-readable display name
          maxLength: 128
          example: Production Environment
        description:
          type: string
          description: Optional description of the environment
          example: Production environment for critical AI agents
        dataplaneRef:
          type: string
          description: Reference to the dataplane
          maxLength: 100
          example: default
        dnsPrefix:
          type: string
          description: DNS prefix for the environment
          maxLength: 100
          example: default
        isProduction:
          type: boolean
          description: Whether this is a production environment
          example: false
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the environment was created
          example: '2026-01-15T10:30:00Z'
        updatedAt:
          type: string
          format: date-time
          description: Timestamp when the environment was last updated
          example: '2026-01-20T14:45:00Z'

    CreateEnvironmentRequest:
      type: object
      required:
        - name
        - displayName
        - dataplaneRef
        - dnsPrefix
      properties:
        name:
          type: string
          description: Unique environment name (lowercase, alphanumeric with hyphens)
          pattern: '^[a-z0-9-]+$'
          minLength: 1
          maxLength: 64
          example: production
        displayName:
          type: string
          description: Human-readable display name
          minLength: 1
          maxLength: 128
          example: Production Environment
        description:
          type: string
          description: Optional description of the environment
          example: Production environment for critical AI agents
        dataplaneRef:
          type: string
          description: Reference to the dataplane
          minLength: 1
          maxLength: 100
          example: default
        dnsPrefix:
          type: string
          description: DNS prefix for the environment
          minLength: 1
          maxLength: 100
          example: default
        isProduction:
          type: boolean
          description: Whether this is a production environment
          example: false

    UpdateEnvironmentRequest:
      type: object
      minProperties: 1
      properties:
        displayName:
          type: string
          description: Updated display name
          minLength: 1
          maxLength: 128
          example: Production Environment (US-East)
        description:
          type: string
          description: Updated description
          nullable: true
          example: Production environment for US East region

    # ============================================
    # AI GATEWAY MANAGEMENT SCHEMAS
    # ============================================

    GatewayType:
      type: string
      enum:
        - AI
        - REGULAR
      description: |
        Gateway type:
        - REGULAR: Handles incoming API traffic
        - AI: Handles outgoing LLM/MCP traffic (used for AI agents)
      example: AI

    GatewayStatus:
      type: string
      enum:
        - ACTIVE
        - INACTIVE
        - PROVISIONING
        - ERROR
      description: |
        Gateway operational status:
        - ACTIVE: Gateway is operational and ready
        - INACTIVE: Gateway is registered but not active
        - PROVISIONING: Gateway is being set up
        - ERROR: Gateway has encountered an error
      example: ACTIVE

    GatewayResponse:
      type: object
      required:
        - uuid
        - organizationName
        - name
        - displayName
        - gatewayType
        - vhost
        - isCritical
        - status
        - createdAt
        - updatedAt
      properties:
        uuid:
          type: string
          description: Unique identifier for the gateway
          example: 7c4a8d09-ca3f-4b0a-82e9-2e85b96dd8a7
        organizationName:
          type: string
          description: Organization UUID
          example: 123e4567-e89b-12d3-a456-426614174000
        name:
          type: string
          description: Unique gateway name (lowercase, alphanumeric with hyphens)
          pattern: '^[a-z0-9-]+$'
          maxLength: 64
          example: ai-gateway-prod
        displayName:
          type: string
          description: Human-readable display name
          maxLength: 128
          example: Production AI Gateway
        gatewayType:
          $ref: '#/components/schemas/GatewayType'
        vhost:
          type: string
          description: Virtual host for the gateway
          maxLength: 253
          example: api.production.example.com
        region:
          type: string
          description: Deployment region
          example: us-east-1
        isCritical:
          type: boolean
          description: Flag indicating if this is a critical production gateway
          example: true
        status:
          $ref: '#/components/schemas/GatewayStatus'
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the gateway was registered
          example: '2026-01-15T10:30:00Z'
        updatedAt:
          type: string
          format: date-time
          description: Timestamp when the gateway was last updated
          example: '2026-02-01T08:00:00Z'
        environments:
          type: array
          description: List of environments mapped to this gateway
          items:
            $ref: '#/components/schemas/GatewayEnvironmentResponse'

    GatewayTokenResponse:
      type: object
      required:
        - gatewayId
        - token
        - tokenId
        - createdAt
      properties:
        gatewayId:
          type: string
          description: Gateway UUID
          example: 7c4a8d09-ca3f-4b0a-82e9-2e85b96dd8a7
        token:
          type: string
          description: New authentication token (only returned once)
          example: gw_1234567890abcdef1234567890abcdef1234567890abcdef
        tokenId:
          type: string
          description: Unique identifier for this token
          example: tok_7c4a8d09ca3f4b0a82e9
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the token was created
          example: '2026-02-12T10:30:00Z'
        expiresAt:
          type: string
          format: date-time
          description: Token expiration time (if applicable)
          example: '2027-02-12T10:30:00Z'

    CreateGatewayRequest:
      type: object
      required:
        - name
        - displayName
        - gatewayType
        - vhost
      properties:
        name:
          type: string
          description: Unique gateway name (lowercase, alphanumeric with hyphens)
          pattern: '^[a-z0-9-]+$'
          minLength: 1
          maxLength: 64
          example: ai-gateway-prod
        displayName:
          type: string
          description: Human-readable display name
          minLength: 1
          maxLength: 128
          example: Production AI Gateway
        gatewayType:
          $ref: '#/components/schemas/GatewayType'
        vhost:
          type: string
          description: Virtual host for the gateway (FQDN or IP)
          minLength: 1
          maxLength: 253
          example: api.production.example.com
        region:
          type: string
          description: Deployment region (optional)
          example: us-east-1
        isCritical:
          type: boolean
          description: Flag indicating if this is a critical production gateway
          default: false
          example: true
        environmentIds:
          type: array
          description: List of environment UUIDs to assign the gateway to during creation
          items:
            type: string
          example:
            - 550e8400-e29b-41d4-a716-446655440000
            - 550e8400-e29b-41d4-a716-446655440001

    UpdateGatewayRequest:
      type: object
      minProperties: 1
      description: Update request for gateway properties (all fields optional, but at least one must be provided)
      properties:
        displayName:
          type: string
          description: Updated display name
          minLength: 1
          maxLength: 128
          example: Production AI Gateway (Updated)
        isCritical:
          type: boolean
          description: Updated critical flag
          example: false
        status:
          $ref: '#/components/schemas/GatewayStatus'

    GatewayListResponse:
      type: object
      required:
        - gateways
        - total
        - limit
        - offset
      properties:
        gateways:
          type: array
          items:
            $ref: '#/components/schemas/GatewayResponse'
        total:
          type: integer
          format: int32
          description: Total number of gateways matching the filter
          example: 5
        limit:
          type: integer
          format: int32
          description: Number of results per page
          example: 20
        offset:
          type: integer
          format: int32
          description: Number of results skipped
          example: 0

    HealthStatusResponse:
      type: object
      required:
        - gatewayId
        - status
        - checkedAt
      properties:
        gatewayId:
          type: string
          description: UUID of the gateway that was checked
          example: 7c4a8d09-ca3f-4b0a-82e9-2e85b96dd8a7
        status:
          type: string
          description: Health check result status
          enum:
            - HEALTHY
            - UNHEALTHY
            - UNREACHABLE
          example: HEALTHY
        responseTime:
          type: string
          description: Response time from the gateway (if reachable)
          example: 45ms
        errorMessage:
          type: string
          description: Error message if health check failed
          example: Connection timeout after 30s
        checkedAt:
          type: string
          format: date-time
          description: Timestamp when the health check was performed
          example: '2026-02-08T15:30:00Z'
