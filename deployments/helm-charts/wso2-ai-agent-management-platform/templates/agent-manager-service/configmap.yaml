{{- if .Values.agentManagerService.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "agent-management-platform.agentManagerService.fullname" . }}
  labels:
    {{- include "agent-management-platform.agentManagerService.labels" . | nindent 4 }}
data:
  OBSERVER_URL: {{ .Values.agentManagerService.config.observerURL | quote }}
  SERVER_HOST: {{ .Values.agentManagerService.config.serverHost | quote }}
  SERVER_PORT: {{ .Values.agentManagerService.service.targetPort | quote }}
  LOG_LEVEL: {{ .Values.agentManagerService.config.logLevel | quote }}
  AUTO_MAX_PROCS_ENABLED: {{ .Values.agentManagerService.config.autoMaxProcsEnabled | quote }}
  AUTH_HEADER: {{ .Values.agentManagerService.config.authHeader | default "Authorization" | quote }}
  DB_OPERATION_TIMEOUT_SECONDS: {{ .Values.agentManagerService.config.dbOperationTimeout | quote }}
  HEALTH_CHECK_TIMEOUT_SECONDS: {{ .Values.agentManagerService.config.healthCheckTimeout | quote }}
  CORS_ALLOWED_ORIGIN: {{ .Values.agentManagerService.config.corsAllowedOrigin | quote }}
  AGENT_WORKLOAD_CORS_ALLOWED_ORIGIN: {{ .Values.agentManagerService.agentWorkload.cors.allowedOrigin | quote }}
  AGENT_WORKLOAD_CORS_ALLOWED_METHODS: {{ .Values.agentManagerService.agentWorkload.cors.allowedMethods | quote }}
  AGENT_WORKLOAD_CORS_ALLOWED_HEADERS: {{ .Values.agentManagerService.agentWorkload.cors.allowedHeaders | quote }}
  API_KEY_HEADER: {{ .Values.agentManagerService.config.apiKey.header | quote }}
  KUBECONFIG: {{ .Values.agentManagerService.config.kubeconfig | quote }}
  OTEL_TRACELOOP_TRACE_CONTENT: {{ .Values.agentManagerService.config.otel.traceContent | quote }}
  OTEL_EXPORTER_OTLP_ENDPOINT: {{ .Values.agentManagerService.config.otel.exporterEndpoint | quote }}
  TRACE_OBSERVER_URL: {{ .Values.agentManagerService.config.traceObserverURL | quote }}
  KEY_MANAGER_ISSUER: {{ .Values.agentManagerService.config.keyManager.issuer | quote }}                                         
  KEY_MANAGER_AUDIENCE: {{ .Values.agentManagerService.config.keyManager.audience | quote }}                                   
  KEY_MANAGER_JWKS_URL: {{ .Values.agentManagerService.config.keyManager.jwksUrl | quote }}                                         
  KEY_MANAGER_DEFAULT_ISSUER: {{ .Values.agentManagerService.config.keyManager.defaultIssuer | quote }}                    
  IS_ON_PREM_DEPLOYMENT: {{ .Values.agentManagerService.config.isOnPremDeployment | quote }}
  IDP_TOKEN_URL: {{ .Values.agentManagerService.config.oidc.tokenUrl | quote }}
  IDP_CLIENT_ID: {{ .Values.agentManagerService.config.oidc.clientId | quote }}
  IDP_CLIENT_SECRET: {{ .Values.agentManagerService.config.oidc.clientSecret | quote }}
  JWT_SIGNING_PRIVATE_KEY_PATH: {{ .Values.agentManagerService.config.jwtSigning.privateKeyPath | default "/app/keys/private.pem" | quote }}
  JWT_SIGNING_PUBLIC_KEYS_CONFIG: {{ .Values.agentManagerService.config.jwtSigning.publicKeysConfig | default "/app/keys/public-keys-config.json" | quote }}
  JWT_SIGNING_ACTIVE_KEY_ID: {{ .Values.agentManagerService.config.jwtSigning.activeKeyId | default "key-1" | quote }}
  JWT_SIGNING_DEFAULT_EXPIRY: {{ .Values.agentManagerService.config.jwtSigning.defaultExpiry | default "8760h" | quote }}
  JWT_SIGNING_ISSUER: {{ .Values.agentManagerService.config.jwtSigning.issuer | default "agent-manager-service" | quote }}
  JWT_SIGNING_DEFAULT_ENVIRONMENT: {{ .Values.agentManagerService.config.jwtSigning.defaultEnvironment | default "default" | quote }}
{{- end }}
